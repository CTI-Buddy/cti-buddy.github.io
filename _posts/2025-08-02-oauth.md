---
layout: post
title: "No Malware Required: OAuth Token Abuse"
date: 2025-08-02
tagline: "How threat actors are weaponizing legitimate authentication flows for persistent cloud access"
image: /IMG/080225.png
tags: [Incident Response, O365, Threat Analysis]
---


|  ![image](https://github.com/user-attachments/assets/e4a24d08-8f14-4aab-9b13-5970331a6243) | 
|:--:| 
| *Who needs an endpoint?* |

[This post](https://www.linkedin.com/posts/floroth_phishing-for-codes-russian-threat-actors-activity-7320705236879224832-q1ld/) from Florian Roth has been living in my head rent-free for months because it's true - also part & parcel to every compromise I've personally dealt with over the last X number of years - so I thought I'd write it up and add it to the pile.  This is intended to be a generic overview of what OAuth is, what it does, how it subsequently can be abused as a result.  We'll summarize the last few big use-cases and go over some detection strategies.

## Introduction

Modern breaches don't always start with malware. Increasingly, they begin and persist with nothing more than a token. [OAuth](https://www.varonis.com/blog/what-is-oauth), the protocol designed to make third-party access to cloud resources safe and flexible, has quietly become one of the most effective tools for threat actors. It enables everything from [silent lateral movement](https://appomni.com/ao-labs/oauth-tokens-danger-behind-commvault-breach/) to durable, cloud-native persistence without dropping a single binary or tripping traditional EDR defenses.

Over the past decade, enterprise security strategies have largely focused on detecting malware, lateral movement, and endpoint anomalies. [But modern breaches, especially in cloud-first organizations, increasingly bypass these defenses entirely](https://unit42.paloaltonetworks.com/2025-cloud-security-alert-trends/). There's no payload to detonate, no command to trace back to a known C2, and often no EDR detection at all. Often and depending on the adversary's objective, there's little reason to compromise a device at all, when the targeted information resides entirely in the cloud.  So instead, access comes through OAuth tokens: small, opaque strings that grant expansive, often long-lived access to cloud services like Microsoft 365, Google Workspace, Slack, Dropbox, and more.

Attackers have realized that the [identity plane](https://arxiv.org/html/2504.17759v1), particularly the OAuth authentication layer, is the weakest link in modern enterprise infrastructure. With the right token and a registered app, they can move directly from phishing to [persistence](https://www.microsoft.com/en-us/security/blog/2023/12/12/threat-actors-misuse-oauth-applications-to-automate-financially-driven-attacks/), skipping many of the traditional intrusion steps that security teams are trained to detect. For SOC analysts, this represents a fundamental shift in the threat landscape that demands new detection approaches, monitoring strategies, and incident response procedures.

This post explores how attackers use access tokens to gain entry, refresh tokens to persist, and cloud-native APIs to operate invisiblyâ€”all without ever setting off a traditional security alarm. We'll examine the technical mechanics behind these attacks, analyze real-world campaigns that have leveraged these techniques, and provide actionable guidance for security teams looking to detect and defend against token-based intrusions in their own environments.

## Understanding OAuth Tokens as Long-Lived Access

At the heart of OAuth-based abuse is a subtle but powerful distinction: attackers aren't necessarily stealing passwords... they're simply [stealing access](https://cloud.google.com/architecture/bps-for-mitigating-gcloud-oauth-tokens). OAuth tokens, particularly refresh tokens, are designed to enable seamless, long-term user sessions without requiring users to log in again. That design choice, while user-friendly, creates an ideal mechanism for persistence that fundamentally challenges traditional security assumptions.

|  ![image](https://github.com/user-attachments/assets/32e1e6cf-43eb-446c-92ea-8b6575d94bd3) | 
|:--:| 
| *OAuth flow, courtesy of [codenx](https://medium.com/codenx/oauth-2-0-4cddd6c7471f)* |


In a [typical OAuth flow](https://medium.com/codenx/oauth-2-0-4cddd6c7471f), once a user grants consent, they receive a short-lived access token, usually valid for about an hour. This token allows access to specific resources like email, calendar, or file storage, depending on the scopes granted during the initial authorization. Behind the scenes, however, a refresh token is also issued. Unlike access tokens, [refresh tokens](https://auth0.com/blog/refresh-tokens-what-are-they-and-when-to-use-them/) are often valid for days, weeks, or even months. Their purpose is to let the client silently request new access tokens without user involvement, creating a seamless experience where applications can maintain long-term access to user data.

This design creates the foothold that attackers exploit. If an attacker obtains a refresh token, for example, via a [consent phishing attack](https://pushsecurity.com/help/what-is-consent-phishing) or through [proxy-based MFA bypass](https://www.menlosecurity.com/blog/the-art-of-mfa-bypass-how-attackers-regularly-beat-two-factor-authentication), they can generate new access tokens repeatedly... long after the initial intrusion. The user may change their password, the attacker may lose access to the initial session cookie, and MFA may be reconfigured, but unless the refresh token is explicitly revoked or expires, it remains valid and functional.

Cloud identity providers like Microsoft Azure AD compound this persistence challenge. In many tenants, refresh tokens can survive password resets and remain usable unless conditional access policies enforce reauthentication or the admin manually revokes sessions. Worse, refresh tokens [may be issued per session or device](https://learn.microsoft.com/en-us/entra/identity/devices/concept-primary-refresh-token?tabs=windows-prt-issued%2Cwindows-prt-used%2Cwindows-prt-renewal%2Cwindows-prt-protection%2Cwindows-apptokens%2Cwindows-browsercookies%2Cwindows-mfa), allowing multiple concurrent footholds that must each be individually addressed during incident response.

This token-based persistence model means that traditional credential hygiene is often insufficient. Defenders must shift focus from only watching for leaked passwords or suspicious login IPs to monitoring for anomalous token reuse, high-risk OAuth app grants, and silent access via long-lived refresh tokens. The challenge for SOC teams becomes identifying [legitimate API usage from malicious token abuse](https://learn.microsoft.com/en-us/defender-cloud-apps/investigate-risky-oauth) when both generate identical traffic patterns to cloud services.

## Core Technique: OAuth Token Lifecycle Abuse

At the heart of every OAuth-based attack is the [token lifecycle](https://learn.microsoft.com/en-us/entra/identity-platform/configurable-token-lifetimes): a workflow designed to simplify secure, delegated access to cloud resources. When misused, it becomes a powerful tool for intrusion, persistence, and exfiltration that operates entirely within the bounds of legitimate service APIs.

OAuth typically issues two types of tokens that serve different but complementary roles in an attack chain. [Access tokens](https://oauth.net/2/access-tokens/) are short-lived, usually valid for about an hour, and grant access to specific APIs or scopes. [Refresh tokens](https://oauth.net/2/refresh-tokens/) are longer-lived, often persisting for days to months, and can mint new access tokens without user interaction. These tokens are issued after the user authenticates and authorizes a third-party or native application, creating what should be a controlled delegation of access rights.

In [legitimate use cases](https://konghq.com/blog/learning-center/what-is-oauth), this system allows users to seamlessly interact with productivity tools, email clients, or mobile apps without repeated logins. However, in attacker workflows, the token itself becomes the breach. The distinction is crucial: rather than breaking into systems, attackers are being invited in through legitimate authorization flows, then exploiting the persistent nature of those authorizations to maintain long-term access.

The first phase of token lifecycle abuse involves access [token theft for initial access](https://curity.io/blog/protect-against-token-and-credential-theft-in-2024/). Access tokens are typically treated as bearer tokens, meaning possession equals permission. If an attacker captures an access token, they can immediately act as the user, issuing API calls against Microsoft Graph endpoints like `/me/messages`, `/me/drive`, and `/me/calendar`, or Google APIs for Gmail, Drive, and Contacts. These tokens can be harvested through consent phishing attacks that trick users into granting access to malicious apps, malware or infostealers that extract tokens from disk or browser cache, or man-in-the-middle proxies that capture access tokens as users log in to legitimate services.

The critical challenge for defenders is that these activities are often indistinguishable from legitimate usage unless specifically monitored at the identity and API level. Traditional network monitoring won't catch this activity because it all flows over standard HTTPS connections to legitimate cloud services. Endpoint detection won't trigger because there's no malicious code execution. The attack lives [entirely in the identity and authorization layer](https://datadome.co/guides/ddos/how-to-detect-and-mitigate-application-layer-attacks/).

The second phase involves refresh token abuse for persistence. If the attacker also captures the associated refresh token, they gain [long-term access that persists beyond typical remediation efforts](https://www.rfc-editor.org/rfc/rfc6749#section-6). Refresh tokens are designed to reissue access tokens silently, often without any user interaction or reauthentication. This makes them functionally equivalent to cloud-native implantsâ€”invisible, durable, and API-enabled backdoors into organizational resources.

During this phase, attackers will repeatedly call the token endpoint to mint new access tokens at regular intervals. A typical refresh request looks like a [standard OAuth flow](https://learn.microsoft.com/en-us/advertising/guides/authentication-oauth-get-tokens?view=bingads-13): `POST https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token` with parameters including `grant_type=refresh_token`, the stolen refresh token, client ID, and requested scopes. To monitoring systems, this appears as normal application behavior, making detection extremely challenging without specific behavioral analytics.

What makes this technique especially dangerous is that everything takes place over legitimate services. The login is real, the tokens are valid, and the API traffic is normal. There's no malware, no beaconing, and no unusual network connections unless defenders are examining identity and API logs at a granular level. This represents a fundamental shift in how attackers establish persistence: rather than maintaining access through technical compromises, they're leveraging legitimate business processes and identity systems.

## Sub-Techniques: Building Blocks of a Cloud Intrusion

The effectiveness of OAuth token abuse stems from a variety of sub-techniques that attackers combine to create sophisticated, persistent access scenarios. Each technique exploits different aspects of the OAuth ecosystem, from user psychology to administrative misconfigurations, creating multiple pathways for initial access and persistence.

[Consent phishing represents the most common initial access vector](https://securitylabs.datadoghq.com/cloud-security-atlas/attacks/malicious-oauth-application-consent/), exploiting the user's trust in familiar login interfaces. Attackers create malicious OAuth applications and trick users into granting consent through legitimate authorization flows. The technical implementation involves registering an application in Azure AD or Google Workspace, crafting phishing emails with legitimate OAuth authorization URLs, and presenting users with authentic Microsoft or Google consent screens. Users [grant permissions](https://www.proofpoint.com/us/blog/email-and-cloud-threats/how-attackers-use-compromised-accounts-create-and-distribute-malicious) believing they're authorizing a legitimate business application, while the attacker receives authorization codes that can be exchanged for long-lived tokens.

|  ![image](https://github.com/user-attachments/assets/fd6597d4-ac45-434c-919b-3122edb8ad39) | 
|:--:| 
| *Tokens, please* |


The sophistication of modern consent phishing campaigns has evolved significantly. Attackers carefully craft application names to [mimic legitimate services](https://www.logpoint.com/en/blog/emerging-threats/how-oauth-and-device-code-flows-get-abused/), such as "Office365_Management" or "SharePoint_Connector," and initially request minimal permissions to avoid triggering user suspicion. Once initial consent is granted, they may use additional consent flows to escalate privileges, gradually building up access to sensitive resources like email, files, and administrative functions.

[Device code flow abuse](https://www.microsoft.com/en-us/security/blog/2025/02/13/storm-2372-conducts-device-code-phishing-campaign/) exploits the authentication mechanism designed for devices without browsers, such as smart TVs or IoT devices. Attackers initiate the device code flow by making a POST request to the OAuth device code endpoint, [receiving a device code and user code in response](https://cloudbrothers.info/en/protect-users-device-code-flow-abuse/). They then social engineer victims to visit the legitimate device login portal and enter the user code, completing the authentication process. While the victim believes they're helping to authenticate a legitimate device, the attacker polls the token endpoint and receives access and refresh tokens for the victim's account.

This technique is particularly insidious because it leverages Microsoft and Google's own device authentication infrastructure. The victim sees legitimate Microsoft or Google branding throughout the process, and the authentication flow appears completely normal. For defenders, device code flows can be difficult to distinguish from legitimate device registrations without careful analysis of user patterns and device characteristics.

[Silent consent via admin-registered applications](https://www.cybermaxx.com/resources/how-does-a-malicious-oauth-application-attack-work-oauth2-research/) exploits pre-approved applications or apps with AdminConsent set to true, eliminating the user prompt that might alert victims to suspicious activity. Advanced persistent threat actors often combine this technique with administrative account compromise, registering applications with broad permissions that can be used across the organization without individual user consent. This approach provides immediate, organization-wide access and is particularly effective in environments where administrative privileges are poorly controlled.  This technique is parituclarly bad because it generally means [total tenant compromise](https://blog.hypr.com/key-takeaways-from-the-entra-id-tenant-compromise).

Token theft via malware and infostealers represents a more traditional but still effective approach. Modern infostealers like [RedLine](https://www.splunk.com/en_us/blog/security/do-not-cross-the-redline-stealer-detections-and-analysis.html), Raccoon, and [Vidar](https://medium.com/@bendavidbenyamin/arkei-variants-from-vidar-to-mars-stealer-3e8c2a24ca24) are increasingly sophisticated at extracting OAuth tokens from browser storage, memory, and disk locations where applications cache authentication credentials. These tools often target the [token storage mechanisms](https://pushsecurity.com/blog/what-the-rise-of-infostealers-says-about-identity-attacks/) used by popular applications like Microsoft Teams, Outlook, and various productivity tools that maintain persistent sessions through refresh tokens.

|  ![image](https://github.com/user-attachments/assets/7368fa10-ad30-4d37-9090-334a3e20b7f3) | 
|:--:| 
| *Multi-tenant abuse, courtesy [Microsoft](https://www.microsoft.com/en-us/security/blog/2023/12/12/threat-actors-misuse-oauth-applications-to-automate-financially-driven-attacks/)* |


[Multi-tenant application abuse](https://www.tenable.com/indicators/ioe/entra/APPLICATION-ALLOWING-MULTI-TENANT-AUTHENTICATION) allows attackers to maximize their return on investment by registering a single malicious application that can be [used across multiple organizations](https://learn.microsoft.com/en-us/entra/identity-platform/single-and-multi-tenant-apps). Once registered as a multi-tenant app, the same application ID can be used to phish users across different Azure AD tenants, allowing attackers to scale their operations efficiently. This technique is particularly dangerous because it allows for [cross-organizational attacks](https://www.wiz.io/blog/azure-active-directory-bing-misconfiguration) using the same infrastructure and application registration.

[Malicious browser extensions](https://blog.sekoia.io/targeted-supply-chain-attack-against-chrome-browser-extensions/) provide another vector for token harvesting and injection. These extensions can [harvest tokens and refresh tokens from legitimate applications](https://blog.koi.security/google-and-microsoft-trusted-them-2-3-million-users-installed-them-they-were-malware-fb4ed4f40ff5?gi=ae0a0322026e), inject additional OAuth scopes silently, or manipulate the consent process to grant broader permissions than users intended. Because browser extensions operate with elevated privileges within the browser context, they can access token storage mechanisms that would be protected from other types of malware.

The persistence phase leverages [refresh token replay](https://auth0.com/docs/secure/tokens/refresh-tokens/refresh-token-rotation) as the primary technique for maintaining long-term access. Attackers use captured refresh tokens to [mint new access tokens repeatedly](https://learn.microsoft.com/en-us/linkedin/shared/authentication/programmatic-refresh-tokens) over time, often automating this process to maintain continuous access. Some sophisticated campaigns implement token management systems that track token lifetimes and automatically refresh tokens before expiration, creating highly resilient persistence mechanisms.

[OAuth applications themselves become backdoors](https://www.microsoft.com/en-us/security/blog/2022/09/22/malicious-oauth-applications-used-to-compromise-email-servers-and-spread-spam/) in many campaigns. Rather than maintaining persistence through traditional implants or scheduled tasks, attackers leverage the registered application as their durable foothold. This approach is persistent until the application is specifically revoked from the tenant, and it provides a legitimate-appearing mechanism for continued access to organizational resources.

[Token persistence via long TTL applications](https://cloud.google.com/apigee/docs/api-platform/antipatterns/oauth-long-expiration) exploits misconfigurations in refresh token lifetime policies. Some organizations configure applications with extremely long refresh token lifetimes, sometimes 90 days or more, creating extended windows of opportunity for attackers. Combined with applications that have broad permission scopes, these configurations can provide attackers with [months of persistent access](https://www.iflockconsulting.com/blog/oauth-phishing) from a single successful compromise.

## Real-World Use Cases

Recent campaigns have demonstrated the real-world effectiveness of OAuth token abuse across various threat actor categories, from nation-state groups to commodity cybercriminals. These cases illustrate how the techniques discussed above translate into operational successes for attackers and detection challenges for defenders.

The [2025 Volexity investigation](https://www.volexity.com/blog/2025/04/22/phishing-for-codes-russian-threat-actors-target-microsoft-365-oauth-workflows/) revealed multiple Russian threat actors conducting highly targeted social engineering operations to gain Microsoft 365 access through OAuth workflows. Since early March 2025, these actors, tracked as [UTA0352](https://malpedia.caad.fkie.fraunhofer.de/actor/uta0352) and [UTA0355](https://malpedia.caad.fkie.fraunhofer.de/actor/uta0355), have been aggressively targeting individuals and organizations with ties to Ukraine and human rights advocacy. The campaigns demonstrate sophisticated social engineering that begins with impersonated European political officials contacting targets via Signal and WhatsApp, inviting them to join video conferences about Ukraine-related matters.


|  ![image](https://github.com/user-attachments/assets/841fe549-3011-4d89-9821-07f3d4085652) | 
|:--:| 
| *With a social engineering twist, courtesy [Volexity](https://www.volexity.com/blog/2025/04/22/phishing-for-codes-russian-threat-actors-target-microsoft-365-oauth-workflows/)* |


The technical execution reveals careful operational planning: attackers create malicious OAuth applications and trick users into granting consent through legitimate authorization flows, with one campaign using Visual Studio Code's [redirect functionality](https://code.visualstudio.com/docs/debugtest/debugging-configuration) to make code extraction appear more legitimate. Rather than requesting broad permissions immediately, these campaigns often started with minimal scopes like basic profile access, then escalated over time. What made these attacks particularly dangerous was their persistence: [refresh tokens allowed continued access](https://www.volexity.com/blog/2025/02/13/multiple-russian-threat-actors-targeting-microsoft-device-code-authentication/) even after password resets and security measure implementations.

In one variation documented by Volexity, attackers used a [compromised Ukrainian Government email account](https://www.volexity.com/blog/2025/04/22/phishing-for-codes-russian-threat-actors-target-microsoft-365-oauth-workflows/) to add legitimacy to their outreach, followed by Signal and WhatsApp messages referencing the initial email. This multi-stage approach combined the authority of official communication with the intimacy of personal messaging platforms, making victims more likely to trust the subsequent OAuth authorization requests.

[Proofpoint's analysis of Microsoft OAuth application impersonation campaigns throughout 2025](https://www.proofpoint.com/us/blog/threat-insight/microsoft-oauth-app-impersonation-campaign-leads-mfa-phishing) revealed threat actors creating fake applications that impersonate trusted enterprise services like RingCentral, SharePoint, Adobe, and DocuSign. These campaigns leveraged multifactor authentication bypass through attacker-in-the-middle phishing kits, [predominantly using the Tycoon platform](https://www.proofpoint.com/us/blog/email-and-cloud-threats/tycoon-2fa-phishing-kit-mfa-bypass). The sophistication became apparent in how attackers customized applications to specific industriesâ€”for example, impersonating ILSMart inventory services when targeting aerospace and defense companies.

|  ![image](https://github.com/user-attachments/assets/d13dcbcf-db82-4ef7-852d-53014364d0b8) | 
|:--:| 
| *More malicious apps, courtesy [Proofpoint](https://www.proofpoint.com/us/blog/threat-insight/microsoft-oauth-app-impersonation-campaign-leads-mfa-phishing)* |


The Proofpoint research documented over 50 impersonated applications across multiple campaigns, with threat actors demonstrating remarkable efficiency in scaling their operations. Whether victims clicked "Accept" or "Cancel" on OAuth consent prompts, they were redirected to counterfeit Microsoft authentication pages designed to harvest credentials and session tokens. This approach effectively bypassed traditional MFA protections because the attacker captured both the [primary credentials and the second factor authentication](https://www.proofpoint.com/us/blog/threat-insight/http-client-tools-exploitation-account-takeover-attacks) tokens in real-time.

The [UK's National Cyber Security Centre analysis of "Authentic Antics" malware](https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/authentic-antics/ncsc-mar-authentic_antics.pdf) revealed a different approach to OAuth abuse, where malware running within the Outlook process displayed malicious login prompts to steal credentials and OAuth tokens. This sophisticated campaign demonstrated how [OAuth abuse could be integrated with traditional malware deployment](https://www.ncsc.gov.uk/news/uk-call-out-russian-military-intelligence-use-espionage-tool), using extensive defense evasion techniques including environmental keying and ntdll.dll unhooking to avoid detection.

What distinguished Authentic Antics was its patient operational approach: the malware only executed once every six days to avoid detection, [communicated exclusively with legitimate Microsoft services](https://cyble.com/blog/uk-exposes-authentic-antics-malware-campaign/), and exfiltrated data by sending emails from victim accounts to attacker-controlled addresses without appearing in sent folders. The malware cleverly exploited user familiarity with Microsoft authentication prompts, generating them from within the legitimate Outlook process to enhance credibility.

Recent commodity cybercriminal campaigns have demonstrated how OAuth abuse techniques have become accessible to lower-skilled threat actors. Business email compromise operations increasingly register applications with [names like "Payroll Docs" or "DocuSign Manager"](https://www.bleepingcomputer.com/news/security/malicious-adobe-docusign-oauth-apps-target-microsoft-365-accounts/) to request `Mail.Send` and `Mail.ReadWrite` permissions, enabling internal phishing and invoice fraud without triggering authentication alerts. Some dark web actors now offer ["Malicious App-as-a-Service" bundles](https://www.resecurity.com/blog/article/evilproxy-phishing-as-a-service-with-mfa-bypass-emerged-in-dark-web), renting out pre-approved applications and stolen refresh tokens to enable turnkey cloud compromise campaigns.

|  ![image](https://github.com/user-attachments/assets/36087266-8e94-4ed8-be39-9f7df8dc6ab3) | 
|:--:| 
| *Behind the scenes, Cpanel for exilproxy* |


[OneDrive File Picker abuse](https://hackread.com/onedrive-file-picker-apps-full-access-user-drives/) represents an emerging trend where attackers exploit legitimate file access flows to request full drive permissions under the guise of document previews. These campaigns take advantage of vague application descriptions and limited default warnings in Microsoft's OAuth consent screens, making it difficult for users to recognize they're authorizing malicious access.

[Cross-tenant application abuse](https://www.semperis.com/blog/noauth-abuse-alert-full-account-takeover/) allows attackers to maximize their return on investment by registering single malicious applications that work across multiple organizations. Once registered as multi-tenant apps, the same application ID can be used to [phish users across different Azure AD tenants](https://sec.okta.com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection/), allowing attackers to scale operations efficiently while reducing infrastructure requirements and detection probability.


## Defensive Considerations

Defending against OAuth token abuse requires a fundamental shift in how security teams approach monitoring, detection, and incident response. Traditional security controls that focus on malware detection, network anomalies, and endpoint protection are [largely ineffective against attacks](https://drsuresh.net/articles/oabuse) that operate entirely within legitimate service boundaries and identity systems.

The foundation of effective OAuth security lies in comprehensive visibility into identity and authentication flows. Organizations must implement detailed logging and monitoring of OAuth consent grants, application registrations, and token usage patterns. This visibility should extend beyond basic authentication logs to include API access patterns, permission scope utilization, and behavioral analytics that can distinguish between legitimate application usage and malicious token abuse.

Microsoft Azure AD and Google Workspace provide [extensive audit logging capabilities](https://learn.microsoft.com/en-us/azure/security/fundamentals/log-audit) that many organizations underutilize. Azure AD audit logs capture OAuth consent grants, application modifications, and token-related activities, while Office 365 audit logs provide detailed records of API access patterns and data operations. Security teams should ensure these logs are ingested into their SIEM platforms and configured with appropriate retention periods to support investigation and threat hunting activities.

Detection strategies must focus on behavioral anomalies rather than technical indicators of compromise. Unlike traditional malware attacks that generate distinctive network traffic or file system modifications, OAuth abuse creates activity patterns that require contextual analysis to identify. Effective detection rules should monitor for applications requesting unusual permission combinations, such as `Mail.Read` paired with `Files.ReadWrite.All`, which could indicate an attacker seeking broad access to organizational data.

### Behavioral Detection over IOC Matching

Unlike malware, OAuth abuse doesnâ€™t create obvious IOCs. The tokens, endpoints, and protocols involved are all legitimate. That means **SOC teams must pivot from signature-based detection to behavioral analysis**, looking for suspicious patterns such as:

- OAuth applications granted high-privilege scopes (`Mail.ReadWrite`, `Files.ReadWrite.All`)
- Newly created applications with generic names mimicking Microsoft services
- Apps registered by new or infrequently used accounts
- Unusual combinations of permission scopes (e.g., `Mail.Read` + `Directory.ReadWrite.All`)
- Token refresh activity from unexpected geographic regions or outside business hours

---

[Geographic and temporal anomalies in token usage](https://www.cyber.gc.ca/en/guidance/guidance-using-tokenization-cloud-based-services-itsp50108) provide another detection opportunity. Tokens being used from geographic locations inconsistent with user travel patterns, API access during off-hours that don't align with user schedules, or token refresh patterns that suggest automated rather than human usage can all indicate compromise. However, these detections require baseline understanding of normal user behavior and must account for legitimate remote work patterns and global business operations.

Application registration monitoring [represents a critical proactive defense capability](https://learn.microsoft.com/en-us/answers/questions/1861991/azure-enterprise-app-app-registration-tracking). Organizations should implement automated monitoring of new application registrations, particularly those created by recently established accounts or those requesting high-privilege permissions. Applications with generic names that attempt to mimic Microsoft services, those lacking proper publisher verification, or those configured with suspicious redirect URIs should trigger immediate security review.

The technical implementation of OAuth monitoring requires sophisticated query capabilities across multiple log sources. Security teams should develop [SIEM rules that correlate OAuth consent events with subsequent API usage patterns](https://www.microsoft.com/en-us/security/blog/2022/11/16/token-tactics-how-to-prevent-detect-and-respond-to-cloud-token-theft/), looking for rapid escalation in data access or administrative activities following new application authorizations. Sample detection logic might monitor for applications that receive consent and immediately begin bulk data enumeration activities, suggesting automated rather than human-driven usage.

[Conditional access policies](https://learn.microsoft.com/en-us/entra/identity/conditional-access/concept-conditional-access-conditions) provide a powerful preventive control mechanism that can significantly reduce OAuth attack surface. Organizations should implement policies that restrict OAuth consent to verified publishers only, require administrative approval for high-privilege applications, and block applications that don't meet specific security requirements. These policies can be configured to allow exceptions for business-critical applications while blocking the broad categories of applications commonly used in OAuth abuse campaigns.


|  ![image](https://github.com/user-attachments/assets/c87ae9f1-b92d-4fa1-b25c-d3389e69bf4c) | 
|:--:| 
| *What is Conditional Access?* |


User education and awareness programs must evolve to address the sophisticated social engineering techniques used in consent phishing campaigns. Traditional phishing awareness training that focuses on suspicious links or attachments is insufficient when attackers are using legitimate Microsoft and Google authorization interfaces. [Security awareness programs should specifically address OAuth consent scenarios](https://www.infosecinstitute.com/resources/phishing/consent-phishing-how-attackers-abuse-oauth-2-0-permissions-to-dupe-users/), teaching users to scrutinize application names, publisher information, and requested permissions before granting access.

Incident response procedures for OAuth abuse require specialized approaches that differ significantly from traditional malware incidents. When OAuth compromise is suspected, responders must quickly identify all applications that have been granted consent by affected users, revoke suspicious tokens and applications, and audit the extent of data access that occurred during the compromise period. This process often requires coordination with cloud service providers and may involve legal considerations around data breach notification requirements.

The remediation process for OAuth abuse can be complex and time-consuming. Simply changing user passwords is insufficient because refresh tokens often survive password resets. [Responders must specifically revoke OAuth tokens and applications](https://techcommunity.microsoft.com/blog/microsoft-entra-blog/how-to-break-the-token-theft-cyber-attack-chain/4062700), which may require administrative privileges and careful coordination to avoid disrupting legitimate business applications. Organizations should develop playbooks that outline the specific steps required to revoke tokens across different cloud platforms and maintain inventories of approved applications to distinguish legitimate tools from malicious ones.

Threat hunting for OAuth abuse requires specialized techniques and tools that can analyze large volumes of API access logs and identity-related events. Hunters should look for patterns such as applications with unusually broad permission grants, tokens being used in automated patterns that suggest scripted access, or applications that were recently registered but immediately began accessing sensitive data across multiple users.

Advanced organizations are implementing OAuth-specific security controls such as application governance platforms that provide continuous monitoring of OAuth applications and their usage patterns. These tools can automatically identify applications that request permissions beyond their apparent functionality, detect applications that are accessing data in patterns inconsistent with their stated purpose, and provide automated response capabilities for high-risk scenarios.


### SIEM Detection Rules and Queries

Here are some practical detection queries and automation ideas for Microsoft 365 environments:

#### 1. Detect OAuth App Consent with Broad Scopes

```kql
AuditLogs
| where OperationName == "Consent to application"
| where Result == "success"
| extend AppName = tostring(TargetResources[0].displayName), 
         Scopes = tostring(TargetResources[0].modifiedProperties[?(@.displayName=="ConsentAction")].newValue)
| where Scopes has_any ("Mail.ReadWrite", "Files.ReadWrite.All", "Directory.ReadWrite.All")
| project TimeGenerated, UserPrincipalName, AppName, Scopes
```

```spl
index=o365 Operation="Consent to application" 
| stats count by UserId, ApplicationName, Scope
| where count > 5 OR like(Scope, "%Mail.Read%Files.ReadWrite%")
```

Detects consent grants involving highly sensitive scopes commonly targeted by attackers.

#### 2. Look for Abnormal Refresh Token Usage

```kql
SigninLogs
| where AuthenticationProtocol == "OAuth2"
| where TokenIssuerType == "AzureAD" and ConditionalAccessStatus == "notApplied"
| where ClientAppUsed == "Refresh Token"
| summarize count() by UserPrincipalName, Location, bin(TimeGenerated, 1h)
| where count_ > 10
```

```spl
index=azuread sourcetype="SigninLogs"
AuthenticationProtocol="OAuth2"
TokenIssuerType="AzureAD"
ConditionalAccessStatus="notApplied"
ClientAppUsed="Refresh Token"
| bin _time span=1h
| stats count by UserPrincipalName, Location, _time
| where count > 10

# if you've got Location enrichment, you could add it or do something with ipAddress like so:
| stats count by UserPrincipalName, ipAddress, _time
```


Flags repeated token refreshes that may indicate automated abuse or persistent access.

#### 3. Monitor for Suspicious Application Registrations

```kql
AuditLogs
| where OperationName == "Add service principal"
| extend AppName = tostring(TargetResources[0].displayName),
         InitiatedBy = tostring(InitiatedBy.user.userPrincipalName)
| where AppName matches regex "(?i)(microsoft|office|365|secure|login).*"
| project TimeGenerated, AppName, InitiatedBy
```

```spl
index=azuread sourcetype="AuditLogs"
OperationName="Add service principal"
| eval AppName=mvindex('TargetResources{}.displayName', 0)
| eval InitiatedBy=mvindex('InitiatedBy{}.user.userPrincipalName', 0)
| where match(AppName, "(?i)(microsoft|office|365|secure|login).*")
| table _time, AppName, InitiatedBy

# a couple additional tricks here might be - excluding verified Microsoft apps or flag registrations by non-admins:
| search NOT InitiatedBy IN ("admin@domain.com", "automation@domain.com")

# or flag entries with no publisher verification:
| eval Suspicious=if(isnull(PublisherName) OR PublisherName="Unknown", "Yes", "No")

```

Detects newly registered OAuth apps that use deceptive or spoofed branding.

---

### PowerShell for Tenant App Auditing

Audit apps with elevated scopes across your tenant:

```powershell
Get-AzureADServicePrincipal | ForEach-Object {
  Get-AzureADServicePrincipalOAuth2PermissionGrant -ObjectId $_.ObjectId
} | Where-Object {
  $_.Scope -match "Mail|Files|Directory"
}
```

Useful for identifying legacy or malicious apps with excessive access.

---

### ðŸš© Red Flag OAuth App Traits

Flag OAuth apps exhibiting any of the following traits:

- App names that mimic Microsoft branding (`OfficeLogin`, `SharePointAuth`)
- No publisher verification badge
- Redirect URIs using `.cf`, `.tk`, `.xyz`, raw IPs, or URL shorteners
- Scopes like:
  - `Mail.ReadWrite`
  - `Files.ReadWrite.All`
  - `Directory.ReadWrite.All`
  - `Mail.Send`

---

### Quick Wins for SOC Teams

- âœ… Ingest Azure AD **AuditLogs**, **SignInLogs**, and **UnifiedAuditLogs**
- âœ… Monitor for consent events involving **broad scopes**
- âœ… Alert on new application registrations by **non-admin users**
- âœ… Enforce Conditional Access to **require verified publishers**
- âœ… Revoke tokens with:
  ```powershell
  Revoke-AzureADUserAllRefreshToken -ObjectId <user-object-id>
  ```
- âœ… Maintain an **approved application allowlist**
- âœ… Train users to scrutinize **OAuth consent prompts**, not just suspicious links

---

### Response and Remediation

> **Reminder:** Changing a userâ€™s password does **not** revoke refresh tokens.

To evict an attacker:
1. Revoke tokens via Azure Portal or PowerShell.
2. Remove the malicious application from the tenant.
3. Audit mailbox, OneDrive, and SharePoint access via Graph logs.
4. Review Conditional Access to enforce reauthentication.
5. Develop IR playbooks specifically for **OAuth token compromise**.

---

## Conclusion

OAuth token abuse represents a fundamental evolution in cloud-based attacks that challenges traditional cybersecurity approaches and requires organizations to rethink their defensive strategies. As cloud adoption continues to accelerate and organizations become increasingly dependent on third-party integrations and OAuth-enabled applications, the attack surface for token-based intrusions will only continue to expand.

The shift from malware-based attacks to identity-based attacks reflects the broader transformation of enterprise IT infrastructure toward cloud-first architectures. Attackers are adapting their techniques to exploit the very systems designed to enable secure, flexible access to cloud resources. This evolution demands that security teams expand their focus from traditional endpoint and network security to comprehensive identity and access management security.

For SOC teams, defending against OAuth abuse requires developing new competencies in identity security, API monitoring, and behavioral analytics. The skills and tools that have been effective against traditional malware campaigns must be supplemented with capabilities specifically designed to detect and respond to token-based attacks. This includes understanding OAuth flows, analyzing API access patterns, and developing incident response procedures tailored to identity-based compromises.

The persistence advantages that OAuth tokens provide to attackers represent perhaps the most significant challenge for defenders. Traditional remediation approaches like password resets and session termination are often insufficient against attackers who have obtained long-lived refresh tokens. Organizations must develop more sophisticated token management and revocation capabilities, along with the processes and tools necessary to implement them effectively during incident response.

Organizations embarking on OAuth security improvements should prioritize comprehensive visibility and monitoring as the foundation of their defensive strategy. Without detailed logging and analysis capabilities for identity and API activities, even the most sophisticated detection rules and response procedures will be ineffective. This visibility must extend across all cloud platforms and identity providers used within the organization, creating a unified view of OAuth activities and potential abuse patterns.

The business impact of OAuth abuse extends beyond traditional data breach concerns to encompass the integrity of cloud-based business processes and the trustworthiness of digital collaboration platforms. As organizations become more dependent on cloud services for core business functions, the potential for OAuth-based attacks to disrupt operations and compromise sensitive information will continue to grow.

Successfully defending against OAuth token abuse requires treating identity as infrastructure, applying the same rigorous security controls and monitoring capabilities traditionally reserved for network and endpoint security. Organizations that embrace this shift and invest in comprehensive OAuth security capabilities will be better positioned to defend against the evolving threat landscape and maintain the security of their cloud-first business operations.
